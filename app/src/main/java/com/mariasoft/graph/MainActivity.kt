package com.mariasoft.graph

import android.app.PendingIntent.getActivity
import android.graphics.Bitmap
import android.graphics.Paint
import android.os.Bundle
import android.os.Environment
import android.text.format.DateFormat
import android.view.View
import androidx.appcompat.app.AppCompatActivity
import java.io.File
import java.io.FileOutputStream
import java.util.*

class MainActivity : AppCompatActivity() {

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

        val xValues = arrayOf(
            7679L,
            7690L,
            7739L,
            7791L,
            7826L,
            7823L,
            7823L,
            7823L,
            7823L,
            7823L,
            7823L,
            7823L,
            7823L,
            7823L,
            7823L,
            7823L,
            7823L,
            7823L,
            7823L,
            8099L,
            8443L,
            8733L,
            8979L,
            9206L,
            9459L,
            9735L,
            10004L,
            10226L,
            10444L,
            10810L,
            11160L,
            11472L,
            11789L,
            12154L,
            12547L,
            12930L,
            13299L,
            13686L,
            14054L,
            14398L,
            14720L,
            14952L,
            14991L,
            14787L,
            14514L,
            14261L,
            14024L,
            13807L,
            13610L,
            13425L,
            13342L,
            13410L,
            13579L,
            13744L,
            13873L,
            13995L,
            14121L,
            14198L,
            14220L,
            14203L,
            14133L,
            13993L,
            13864L,
            13770L,
            13696L,
            13629L,
            13582L,
            13587L,
            13602L,
            13653L,
            13725L,
            13777L,
            13824L,
            13842L,
            13862L,
            13863L,
            13825L,
            13784L,
            13736L,
            13687L,
            13648L,
            13616L,
            13581L,
            13571L,
            13560L,
            13581L,
            13626L,
            13638L,
            13615L,
            13633L,
            13654L,
            13640L,
            13625L,
            13612L,
            13584L,
            13543L,
            13524L,
            13523L,
            13493L,
            13449L,
            13444L,
            13460L,
            13445L,
            13427L,
            13424L,
            13430L,
            13404L,
            13390L,
            13393L,
            13356L,
            13314L,
            13310L,
            13310L,
            13310L,
            13310L,
            13310L,
            13310L,
            13341L,
            13341L,
            13341L,
            13341L,
            13341L,
            13341L,
            13341L,
            13341L,
            13212L,
            12711L,
            12340L,
            12071L,
            11841L,
            11567L,
            11272L,
            10997L,
            10741L,
            10438L,
            10123L,
            9813L,
            9470L,
            9092L,
            8696L,
            8320L,
            7909L,
            7453L,
            7009L,
            6626L,
            6227L,
            5916L,
            5863L,
            6036L,
            6327L,
            6636L,
            6920L,
            7222L,
            7515L,
            7728L,
            7836L,
            7792L,
            7596L,
            7373L,
            7150L,
            6942L,
            6764L,
            6611L,
            6522L,
            6542L,
            6660L,
            6830L,
            7021L,
            7184L,
            7318L,
            7468L,
            7554L,
            7557L,
            7521L,
            7441L,
            7315L,
            7201L,
            7119L,
            7045L,
            6997L,
            6981L,
            7034L,
            7116L,
            7219L,
            7314L,
            7413L,
            7501L,
            7556L,
            7605L,
            7615L,
            7574L,
            7535L,
            7491L,
            7433L,
            7392L,
            7417L,
            7441L,
            7433L,
            7466L,
            7623L
        )
        val yValues = arrayOf(
            8679L,
            8690L,
            8739L,
            8791L,
            8826L,
            8823L,
            8823L,
            8823L,
            8823L,
            8823L,
            8823L,
            8823L,
            8823L,
            8823L,
            8823L,
            8823L,
            8823L,
            8823L,
            8823L,
            9099L,
            9443L,
            9733L,
            9979L,
            10206L,
            10459L,
            10735L,
            11004L,
            11226L,
            11444L,
            11810L,
            12160L,
            12472L,
            12789L,
            13154L,
            13547L,
            13930L,
            14299L,
            14686L,
            15054L,
            15398L,
            15720L,
            15952L,
            15991L,
            14787L,
            14514L,
            14261L,
            14024L,
            13807L,
            13610L,
            13425L,
            13342L,
            13410L,
            13579L,
            13744L,
            13873L,
            13995L,
            14121L,
            14198L,
            14220L,
            14203L,
            14133L,
            13993L,
            13864L,
            13770L,
            13696L,
            13629L,
            13582L,
            13587L,
            13602L,
            13653L,
            13725L,
            13777L,
            13824L,
            13842L,
            13862L,
            13863L,
            13825L,
            13784L,
            13736L,
            13687L,
            13648L,
            13616L,
            13581L,
            13571L,
            13560L,
            13581L,
            13626L,
            13638L,
            13615L,
            13633L,
            13654L,
            13640L,
            13625L,
            13612L,
            13584L,
            13543L,
            13524L,
            13523L,
            13493L,
            13449L,
            13444L,
            13460L,
            13445L,
            13427L,
            13424L,
            13430L,
            13404L,
            13390L,
            13393L,
            13356L,
            13314L,
            13310L,
            13310L,
            13310L,
            13310L,
            13310L,
            13310L,
            13341L,
            13341L,
            13341L,
            13341L,
            13341L,
            13341L,
            13341L,
            13341L,
            13212L,
            12711L,
            12340L,
            12071L,
            11841L,
            11567L,
            11272L,
            10997L,
            10741L,
            10438L,
            10123L,
            9813L,
            9470L,
            9092L,
            8696L,
            8320L,
            7909L,
            7453L,
            7009L,
            6626L,
            6227L,
            5916L,
            5863L,
            6036L,
            6327L,
            6636L,
            6920L,
            7222L,
            7515L,
            7728L,
            7836L,
            7792L,
            7596L,
            7373L,
            7150L,
            6942L,
            6764L,
            6611L,
            6522L,
            6542L,
            6660L,
            6830L,
            7021L,
            7184L,
            7318L,
            7468L,
            7554L,
            7557L,
            7521L,
            7441L,
            7315L,
            7201L,
            7119L,
            7045L,
            6997L,
            6981L,
            7034L,
            7116L,
            7219L,
            7314L,
            7413L,
            7501L,
            7556L,
            7605L,
            7615L,
            7574L,
            7535L,
            7491L,
            7433L,
            7392L,
            7417L,
            7441L,
            7433L,
            7466L,
            7623L
        )

        val paint = Paint()
        paint.strokeWidth = 5f
        paint.color = -0xffff01
        val dataSet = DataSet(xValues, yValues, paint, DataSet.GraphType.STANDARD_LINE)
        val sets: MutableList<DataSet> = ArrayList()
        sets.add(dataSet)

        val graphView: GraphView = findViewById(R.id.graphView)
        graphView.isDrawingCacheEnabled = true

        graphView.addToPrimaryDataSet(dataSets = sets)
        graphView.setLabels()
    }
    private fun takeScreenshot() {
        val now = Date()
        DateFormat.format("yyyy-MM-dd_hh:mm:ss", now)
        try {

           // graphViewTop.setDrawingCacheEnabled(true)
            //graphViewBottom.setDrawingCacheEnabled(true)
            // image naming and path  to include sd card  appending name you choose for file
            val mPath =
                Environment.getExternalStorageDirectory().toString() + "/" + now + ".jpg"
            // create bitmap screen capture
            val v1: View = window.decorView.rootView
            v1.isDrawingCacheEnabled = true
            val bitmap = Bitmap.createBitmap(v1.drawingCache)
         //   graphViewTop.setDrawingCacheEnabled(false)
           // graphViewBottom.setDrawingCacheEnabled(false)
            v1.isDrawingCacheEnabled = false
            val imageFile = File(mPath)
            val outputStream = FileOutputStream(imageFile)
            val quality = 100
            bitmap.compress(Bitmap.CompressFormat.JPEG, quality, outputStream)
            outputStream.flush()
            outputStream.close()
        } catch (e: Throwable) { // Several error may come out with file handling or DOM
            e.printStackTrace()
        }
    }

    fun take(view: View) {
        takeScreenshot()
    }

}
